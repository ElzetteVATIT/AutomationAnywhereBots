{"triggers":[],"nodes":[{"uid":"9971b10a-099c-4d69-9201-d4cb673ea856","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ef82e8e8-e161-40bd-aef6-03817298a23f","commandName":"replace","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sFolder_path$"}},{"name":"find","value":{"type":"STRING","string":"\\"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"/"}}],"returnTo":{"type":"VARIABLE","variableName":"sFolder_path"}},{"uid":"82bffc18-fb0d-4a1b-8b66-e2c15d45914d","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFolder_path$/AuditDetails.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"bbb6118f-eeff-4395-8287-7f45f1d47cbe","commandName":"replace","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sFolder_path$"}},{"name":"find","value":{"type":"STRING","string":"/"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"\\"}}],"returnTo":{"type":"VARIABLE","variableName":"sFolder_path"}},{"uid":"41724c9f-dc65-4253-864f-ce1d88f268fb","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"T2"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"returnTo":{"type":"VARIABLE","variableName":"sCreatorID"}},{"uid":"67d2006d-d627-4f10-b93f-8ba04edd1dfd","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":"elzertteb@vatit.com"}},{"name":"bcc","value":{"type":"STRING","string":"matthewr@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nFolder path:.$sFolder_path$<br>\n<br>\nViper audit process has been started.<br>\n<br>"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"type":"STRING","string":"Basic"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Open Excel"}}]},{"uid":"9bd2268c-70f7-43b7-bb9d-6030f6f8a0e9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2f19111c-d0f2-462a-9cd9-3742c4eb073b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"97ade437-1e3a-4640-aa95-e4282cd20fd6","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"AuditID"}}]},{"uid":"fc02300b-cd03-4997-8dd9-aeb19b14ce15","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"ClientCode"}}]},{"uid":"ea1b7cd0-6719-41d9-baf4-24a79b3921e7","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"C1"}},{"name":"value","value":{"type":"STRING","string":"Entity"}}]},{"uid":"7315be9f-e37f-45d1-ac7d-eab7c52df58d","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"D1"}},{"name":"value","value":{"type":"STRING","string":"ExpenseCountry"}}]},{"uid":"d661d48e-0df2-48a8-9302-c98ce9bf8bcd","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"E1"}},{"name":"value","value":{"type":"STRING","string":"Year"}}]},{"uid":"892c34e8-7e1a-4d0a-8329-21f61c6a8c66","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"F1"}},{"name":"value","value":{"type":"STRING","string":"#images"}}]},{"uid":"5e8914d7-ec5d-49fc-89d1-ae34131decd8","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A2"}}]},{"uid":"15f4c97b-20b6-4db5-8252-2b77838c4be4","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Dragon"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"vt-prod-app-lst"}},{"name":"database","value":{"type":"STRING","string":"dragon"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"username"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"c92af7a7-d8ab-4cbc-b809-f704ad9f9539","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"vt-prod-app-lst"}},{"name":"database","value":{"type":"STRING","string":"viper"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"username"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8971ebf5-6c2b-45f9-9d6b-dfbba41ffb6a","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"04411c55-6e70-4b05-92e1-7c9234d5a707","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"12c9e9b3-fc57-4802-acd2-4fa14d5792bf","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sCurrent_folder$"}},{"name":"delimiter","value":{"type":"STRING","string":"_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lAudit_details"}},{"uid":"83bfe4a7-4e8e-434d-8f63-4c2e9147db9b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ccf1ae5c-3a69-484c-a0e1-d937486c1866","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Dragon"}}]},{"uid":"23098d20-0b24-4c78-b36c-a9dc9774cbe9","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Dragon"}},{"name":"query","value":{"type":"STRING","expression":"select distinct UPPER(REPLACE(EntityCode#ClientCore,'GUID_','')) AS ClientID, name from VT_ClientCore where type <> 'c' and clientcode in ('$lAudit_Details[0]$')"}}],"returnTo":{"type":"VARIABLE","variableName":"tEntity_Code"}},{"uid":"11cdf718-f0a3-451b-bbc1-73f66ddfd5c8","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Dragon"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get entity code from Dragon "}}]},{"uid":"1433542f-6740-42d3-99e2-ff3404cb66b2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c75d8272-bdf0-4de8-ae29-2e5c9dc0a394","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]},{"uid":"44699669-f480-46b2-8675-a20bb7b921ea","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}},{"name":"query","value":{"type":"STRING","expression":"select id from SY_PeriodType where name = '$lAudit_details[2]$'"}}],"returnTo":{"type":"VARIABLE","variableName":"tPeriodID"}},{"uid":"177e3be7-a167-48c9-a262-71c38a129663","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get period ID from Viper"}}]},{"uid":"926f5a01-22b5-4756-8cd1-273113931ec7","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f8ef69cb-5cc2-4750-920a-84932ca1a666","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"('$tentity_code[0][0]$','$laudit_details[0]$',4,'$laudit_details[3]$',$laudit_details[1]$,$tperiodID[0][0]$,1,GetDate(),Getdate(),$sCreatorID$,$sCreatorID$)"}}],"returnTo":{"type":"VARIABLE","variableName":"sCreate_audit"}},{"uid":"a6c9bb00-34a0-48f9-8d4f-567e966547c1","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]},{"uid":"ea0b8906-4d93-4376-9a3f-c297a80c16d6","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO AU_Audit(EntityCode, ClientCode, ClientTypeID, ExpenseCountry, AuditYear,PeriodTypeID, StatusID, CreationTime, LastModifiedTime, CreatorID, LastModifierID) VALUESÂ $sCreate_Audit$"}}]},{"uid":"2095a22a-e742-4061-8b64-53f6cb211d11","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Create audit - Insert into Viper DB "}}]},{"uid":"89da6a66-485b-493a-b029-de0ea249a7e7","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a7bd0b7b-2495-42c9-9cf5-44a15591eddb","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]},{"uid":"61cf787d-dcc5-4448-b362-226d7c96e7dd","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}},{"name":"query","value":{"type":"STRING","expression":"select max(id) from AU_Audit where clientcode = '$lAudit_details[0]$' and ExpenseCountry = '$lAudit_details[3]$' and AuditYear = $lAudit_details[1]$ and PeriodTypeID = $tPeriodID[0][0]$ and ClientTypeID = 4 and StatusID = 1"}}],"returnTo":{"type":"VARIABLE","variableName":"tAuditID"}},{"uid":"e981ce8c-9bda-4d74-af74-1fb187777802","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Retrieve audit ID "}}]},{"uid":"f3d1a5cb-8e99-461e-9a67-8ba7b0366488","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"164b631b-d5ed-4fd7-9ca2-6388b659fcb0","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sAuditors$"}},{"name":"delimiter","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lAuditor_List"}},{"uid":"0d62e35d-3009-4aea-8789-cceba7bf2144","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]},{"uid":"e93f554c-dad2-4564-8ac5-97ab4d2c73cb","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"bc17f35c-c1bd-4da0-8e77-9f67c6c7ac46","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO AU_Auditor(AuditID, UserID) VALUES ($tAuditID[0][0]$,$sAuditorID$)"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"sAuditorID"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lAuditor_List"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"3073b3fe-07ee-4eef-a903-bbf7aae4f901","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Add auditors"}}]},{"uid":"2a42b98a-70dd-4f05-b518-0303c6a23a4d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"90af4a36-8dd2-4098-a930-5dbf924a6695","commandName":"renameFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sFolder_path$\\$sCurrent_folder$"}},{"name":"newFolderName","value":{"type":"STRING","expression":"$sFolder_Path$\\$tAuditID[0][0]$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Rename folder"}}]},{"uid":"09f3cccf-2973-49d2-a4c5-24117b4398f6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5aec7e6f-7ef1-4e76-914d-86c6ec6c4f84","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$tAuditID[0][0]$"}}]},{"uid":"2d215281-02c4-464c-ac63-5e0be19c287f","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"8284fc66-9a93-4b98-bda0-a225f6cc2147","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$lAudit_details[0]$"}}]},{"uid":"9340e47b-82a6-478e-a455-fc3781705401","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"62b34c29-d098-411b-8f69-710be22c3a36","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$tEntity_Code[0][1]$"}}]},{"uid":"df12898b-3f8d-4418-a211-91c170202522","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"a28da010-32d4-40e7-8035-d4092de78418","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","string":"MIXED"}}]},{"uid":"8c89ad62-a8a2-48d2-8780-daedd8ed72c5","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"52e7057e-6963-4eb5-a5a9-9522281eca22","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$lAudit_details[1]$"}}]},{"uid":"0eefcc3d-aaa3-4312-9cc5-6437a0760eaf","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"e6d8fb2c-13ba-47c4-87c1-18698a260dcd","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5052eee5-e7c9-4b26-b626-cceca52acd32","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}},{"uid":"a3cafc51-1bbc-4c4b-aa71-d22c50bfc984","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"20cfd1a4-b206-46ad-b22f-1c4c947830d5","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dFile_to_count"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sFolder_path$\\$tAuditID[0][0]$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"edc9fa1c-8830-4ed3-b5cf-081c7bc319e9","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sCounter"}},{"uid":"b7a6002b-f350-4fad-8fb7-a824a8e8c6c9","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$sCounter$"}}]},{"uid":"24330197-52bd-48fe-8a00-808a389751ae","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellDown"}}]},{"uid":"f0147eae-b76e-4d32-8c24-5a203d598ff2","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"BeginningOfRow"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get image count"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Update audit details in Excel"}}]},{"uid":"4ed3f1db-999e-4e1e-a6bd-aab7b3c334a6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"497a416d-e62b-4793-9e6f-b64f2016b6b3","commandName":"copyFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"sourceFolderPath","value":{"type":"STRING","expression":"$sFolder_path$\\$tAuditID[0][0]$"}},{"name":"destinationFolderPath","value":{"type":"STRING","string":"\\\\vt-prod-vpr-vm\\VatIT\\Images\\ToProcess"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Copy to Viper ToProcess folder"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sCurrent_folder$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"Exceptions"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sCurrent_folder$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"Processed"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sCurrent_folder$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"Processed_images"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"sCurrent_folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sFolder_path$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.folder","packageName":"Folder"}}]},{"uid":"35e66501-a045-417a-98d2-65ef99f0de08","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Dragon"}}]},{"uid":"470a1972-b82d-4487-8569-a0297e936f7f","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Viper"}}]},{"uid":"9169c9d4-0fdf-4e8c-b3c7-7a86753e3b78","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}],"branches":[{"uid":"6089a7bb-6588-4a18-bbb4-154cfa75f9ae","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"606b2d22-a0e2-4998-9448-7f4a1230e8a0","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"0faf1360-14a9-414c-9864-61043df15c8c","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Viper Audit bot has FAILED"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe Viper Audit bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>CREATOR ID WAS NOT SUPPLIED</strong><br>\n<br>\nThis is the current file path: $sFolder_path$ <br>\n<br>\n<strong>ERROR MESSAGE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease make sure that the creator ID exists and then try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"type":"STRING","string":"Basic"}}]},{"uid":"7e313e41-d3cb-4989-8968-db9361a5e9f6","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Preparing for Viper audits"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sFolder_path","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sCreatorID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAuditors","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"5,115,224,17,9"}},{"name":"sCurrent_folder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"tEntity_Code","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"tPeriodID","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"sCreate_audit","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"lAudit_details","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"tAuditID","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"lAuditor_List","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"sAuditorID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dFile_to_count","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sCounter","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sEmailRecipient","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLine","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sDetails_File","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["12c9e9b3-fc57-4802-acd2-4fa14d5792bf","41724c9f-dc65-4253-864f-ce1d88f268fb","9169c9d4-0fdf-4e8c-b3c7-7a86753e3b78"],"packages":[{"name":"Database","version":"2.2.0-20201013-052941"},{"name":"Email","version":"3.1.0-20201104-062204"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"Folder","version":"3.0.0-20201016-065517"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"TaskBot","version":"2.0.1-20201023-202703"}],"workItemTemplateName":null}