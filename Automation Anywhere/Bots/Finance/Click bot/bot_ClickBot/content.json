{"triggers":[],"nodes":[{"uid":"be196619-2815-414b-aa8a-d3b82f7fd08d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e791c2fc-df7e-49f6-be31-b0f327680284","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://blaze.vatit.com:1611"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIURL"}},{"uid":"66b4caef-2f61-4848-bffb-921a35a0c376","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://blaze.vatit.com:1611/blaze-api/1.0/fee-calculations/calculate"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIPosrtURL"}},{"uid":"6532b079-66a9-484a-ba30-c63af4e0339b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"reconciled"}}],"returnTo":{"type":"VARIABLE","variableName":"sClassification"}},{"uid":"3ccfc250-2e56-4936-9e3c-eced06223c30","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"null"}}],"returnTo":{"type":"VARIABLE","variableName":"sCreditNoteID"}},{"uid":"5e53ce03-6978-4b4e-8eb7-f684bd50d2a9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\automation\\VATit Processing (Pty) Ltd\\VAT IT Automation - Bots Working Folders\\Finance\\ClickBot"}}],"returnTo":{"type":"VARIABLE","variableName":"sFilePath"}},{"uid":"07faa5aa-9013-4921-8a79-a1f43df98bdc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"natasjavh@vatit.com"}}],"returnTo":{"type":"VARIABLE","variableName":"sDefaultRecipient"}},{"uid":"2128c995-5a5b-43cd-9e9b-63bfaf6b47e7","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"4d53f415-25f1-4842-98ad-6542f0772ebb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\elzetteb\\Downloads"}}],"returnTo":{"type":"VARIABLE","variableName":"sFilePath"}},{"uid":"8053deda-af2c-4ba6-9014-2f1fa1bb45bb","commandName":"assign","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceDictionary","value":{"type":"DICTIONARY","dictionary":[{"key":"emailMessage","value":{"type":"STRING","string":"954F72\"><div class=\"WordSection1\"><p class=\"MsoNormal\">6702<o:p></o:p></p><p class=\"MsoNormal\"><o:"}},{"key":"emailFrom","value":{"type":"STRING","string":"elzetteb@vatit.com"}}]}}],"returnTo":{"type":"VARIABLE","variableName":"dEmailDetails"}},{"uid":"64df92b7-bb1f-4fe4-ab3d-a7ec5841ccb7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"elzetteb@vatit.com"}}],"returnTo":{"type":"VARIABLE","variableName":"sDefaultRecipient"}},{"uid":"3eeb5bb8-e3bd-4378-a546-0f8b66bd0952","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"File"}}],"returnTo":{"type":"VARIABLE","variableName":"sSource"}},{"uid":"51bdca00-15e4-47a9-a1f9-804d2f3ff587","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Email"}}],"returnTo":{"type":"VARIABLE","variableName":"sSource"}},{"uid":"4a72ac84-741f-4110-95e5-19e7ecfc2da4","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"4265882d-d6c3-4a9c-abfa-aa550ac6811b","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"6700"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchID"}},{"uid":"e8c70ace-4f9e-40cf-8ece-271fcc97d7d8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://dragon-uat.vatit.com:1611"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIURL"}},{"uid":"315735a5-e9b2-410c-b159-b731ed1a45a0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"http://vt-uat-drg1-vm:1630/api/1.0/fee-calculations/calculate"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIPosrtURL"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"UAT testing"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"INPUT VALUES FOR TESTING"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Variable declaration "}}]},{"uid":"67ce2311-5ae2-4aab-a61a-6b43ee522a3c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e65b5d4f-f9af-4317-9180-4059db2b3008","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cbd5fe84-92ea-4030-b72e-20b3119d0db1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dEmailDetails{emailMessage}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailMessage"}},{"uid":"7e7c8ab7-7233-4ccd-9145-25e249c051a7","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sEmailMessage$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"<div class=\"WordSection1\"><p class=\"MsoNormal\">"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"<o:p></o:p>"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailMessage"}},{"uid":"8a941b95-c6d8-418b-87bb-e4649e0e00ff","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dEmailDetails{emailFrom}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}},{"uid":"b3fc7742-ba08-42db-bcef-3833bacff586","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sEmailMessage$"}},{"name":"delimiter","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"LBatchIDs"}},{"uid":"c0298aed-32b5-4075-9b03-ad38952df2b5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e1c06b28-2fb1-41b1-a24a-66f62667f4e9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"996e42e9-c85e-44a2-b70d-c200bdec6314","commandName":"CreateSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot-Urgent.xlsx"}},{"name":"sheetName","value":{"type":"STRING","string":""}},{"name":"passwordToOpen","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"passwordToEdit","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"b78ccb26-8182-4a64-9b3b-03f106ee55bb","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"BatchID"}}]},{"uid":"72bb73fb-f51e-4f06-9f2b-9391aaacfb18","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"EmailAddress"}}]}],"branches":[{"uid":"88149d5b-7a72-450d-94f1-e8955e753619","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"3dc08685-7cbd-4b04-a909-36ffff3f2847","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot-Urgent.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"810fb46c-d629-4d9c-a464-ceabae034696","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"BatchID"}}]},{"uid":"835854ea-76e4-4e7d-ba36-60f75e66f768","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"EmailAddress"}}]},{"uid":"b9760528-410b-4021-bd9e-479641363855","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot-Urgent.xlsx"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"f9c37f07-27a1-4fdb-a8a4-0df610b0a123","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot-Urgent.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"56dd4bbc-8879-4c79-97db-e44ffba7ed5a","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A2"}}]}],"branches":[{"uid":"6c333e6f-840d-4405-bfa5-e15b7eb59333","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a9ce5aa4-2cd7-4b41-af6e-a2428dab548d","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"10582570-42e5-4d2f-84b6-91f9624c5f89","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Error line: $sErrorLine$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"47329acb-60bd-45a8-8d66-4f5139c6aa86","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe click bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO FIND FILE PATH</strong><br>\n<br>\nThis is the current file path: $sFilePath$<br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease make sure that the file path exists and then try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong><br> \n<br> \n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"32a59b47-96ab-4811-98b9-f601c05b97c6","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f2384016-df4f-443b-b1ee-dcccd251c96f","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]},{"uid":"a762e631-c9c3-48d8-9555-23b17be514e7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5c85f04d-5630-46e0-9980-69a9a862aead","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$sCurrentBatchID$"}}]},{"uid":"c9c93e4f-6d7e-4663-9dc2-b2eae3bba011","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"68c0ecad-9dd0-4b05-9182-a0c22fee9f63","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$sEmailRecipient$"}}]},{"uid":"7f115124-f870-43d1-a111-b3a18d83aaea","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellDown"}}]},{"uid":"5ac2db38-67f4-4d19-aac9-423114f95f5a","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellLeft"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"sCurrentBatchID"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"LBatchIDs"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"branches":[{"uid":"21c9caf9-ffd1-4784-ad9e-22ce3bd25796","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"36b2459e-f18c-48ee-851b-0181a05f87bd","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"badaa03a-daa4-4938-889c-b7354d0a5a34","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"99eaa7d0-07e5-4eaa-9c4e-3f1f263c7da1","commandName":"SetCell","packageName":"Excel","disabled":true,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"BatchID"}}]},{"uid":"6cd61064-786d-4867-a22a-1ad9525852dd","commandName":"SetCell","packageName":"Excel","disabled":true,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"EmailAddress"}}]},{"uid":"88ace385-1d3a-4693-af25-1f856b40ea81","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":true,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]},{"uid":"bdfb7355-18c6-4acf-9351-0377c6e53a45","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/ClickBot.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"28059a80-b511-466c-9782-4986647c983a","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"3"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]}],"branches":[{"uid":"c6853d8e-275e-4846-a442-8050549a68be","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f4d6ac94-eb80-405f-843b-9d94d23bf78c","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"ebc4e737-54e3-4fab-a4ac-5bf3242b4f06","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b22cf8c0-7852-4389-9346-5adcba0d8c12","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe click bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO FIND THE FILE</strong><br>\n<br>\nThis is the current file path of the file: $sFilePath$<br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease make sure that that the file contains the following information: <br>\n<br> \nTitle: ClickBot<br>\n<br>\nHeading 1: BatchID<br>\n<br>\nHeading 2: EmailAddress<br>\n<br>\nFilepath: $sFilePath$\n<br>\nThis bot will run again in 24 hours. \n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"7ac19b0b-5d62-4407-adf5-67358ee90686","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSource$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"File"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"a3cb0adc-2f64-467d-957b-5ae75ec1bde4","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"bae4f323-47a0-4f42-b0fb-f9eac43ff6e1","commandName":"stopTask","packageName":"TaskBot","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSource$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Email"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Find source of data"}}]},{"uid":"a94f745a-948b-4121-8b7a-f80d8cd4e530","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"80504040-5e76-4a2a-a036-a971c54fc64f","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}},{"uid":"3284740c-7319-45e4-af59-0fd0ca391646","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"15e6bc3b-115c-433c-91db-db5c000ea42e","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"590750c8-532e-42cf-a8f9-2ff965f87c9e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sCounter"}},{"uid":"8ce427db-b3a6-440b-b2d6-a2924c0d9000","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCurrentBatchDetails[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchID"}},{"uid":"2ce1e134-0007-4596-a36e-c9346c98586e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCurrentBatchDetails[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}},{"uid":"c81e1e3d-fecc-40ee-bc5f-eb6f5de044bb","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c713311b-3169-4918-8af3-f19402933563","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sDefaultRecipient$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":" "}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"2d075f67-3864-4903-901d-7cf57c3c0c76","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e9ba11c0-e03e-40d5-b1d2-d694037c9a81","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sDefaultRecipient$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"@"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"."}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"34354144-083f-43a1-8703-34832d6c223b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"1e4c90e1-e238-40db-8262-0855aef60ee9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"22387b7a-8863-4b5c-84b9-86dea47c9188","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"358e7ebb-373a-4972-9f3a-bcc5fa836d63","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIURL$/login"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"headerContentType","value":{"type":"STRING","string":"application/x-www-form-urlencoded"}},{"name":"urlEncodedPostParameters","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"user"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Dragon Credentials","lockerName":"Automation Credentials","attributeName":"UserName"}}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"pass"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Dragon Credentials","lockerName":"Automation Credentials","attributeName":"Password"}}}]}]}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"dLoginResponse"}},{"uid":"b5148d3a-1f38-4718-9844-e871b49212ae","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dLoginResponse{\"Set-Cookie\"}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":":"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sCookie"}},{"uid":"f7e97a57-8068-40d2-8bb8-7df89f2dd177","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"DragonUser=\"Elzette Buys\";$sCookie$"}}],"returnTo":{"type":"VARIABLE","variableName":"sCookie"}}],"branches":[{"uid":"8de750b9-0253-4ac8-8da5-0548ffc373ae","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5421a712-379c-4d13-a893-a9fb52917021","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"d07bb040-296a-4cad-8b66-b6097c6164e6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dLoginResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sResponse"}},{"uid":"9c0779ec-9923-40c5-ad90-e94a4dade662","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$, Response: $sResponse$  "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"79fadb24-8ad0-4c94-9f1b-a4281f5aef71","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO CONNECT TO DRAGON</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nRESPONSE MESSAGE: $sResponse$ <br>\n<br> \nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong> or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"7d29c920-e99c-4f6d-aafc-c82a16b9a407","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f45b0c01-e3fa-4298-95c4-5f325774d59a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Dragon authentication "}}]},{"uid":"868a69fa-4e10-440a-9783-d0abc7bb41ca","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b6789ff5-07e5-4e1b-b28f-b38ecbc2bdc5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"064ee2b3-0c33-4ad8-820f-8c6d1bdd9b9e","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIURL$/blaze-api/1.0/payments/batches/items/grid-view?batchIds=$sBatchID$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"dBatchResponse"}},{"uid":"792a4434-d11a-40cf-a787-5e6308355876","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonString","value":{"type":"STRING","expression":"$dBatchResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchResponse"}},{"uid":"bb40acda-1053-4009-aab5-c055005571af","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"paymentBatchItems.length() "}}],"returnTo":{"type":"VARIABLE","variableName":"sNumberOfBatchItems"}},{"uid":"a05b79b9-b823-4aca-b4a9-db0e79f0a7f8","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ef8dbe19-a6ab-4e97-ba1a-4974f64543ae","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nCurrentpaymentBatchItem$-1"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentpaymentBatchItem"}},{"uid":"b54ef166-c6c4-4bb0-9edc-0961e6878ad4","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].batchItemId"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchItemID"}},{"uid":"cdab34bd-f2f3-4fe4-8564-8fad95153ed2","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].batchItemTypeName"}}],"returnTo":{"type":"VARIABLE","variableName":"sbatchItemTypeName"}},{"uid":"a9a87e97-dd7d-491e-8bda-472dec9d7f92","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].branchId"}}],"returnTo":{"type":"VARIABLE","variableName":"sBranch"}},{"uid":"d2493671-f628-44af-912d-020ab2c4c49d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"edbca049-edd4-4896-9407-f1ca3cdfa311","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c6977d92-a12b-471b-b967-0f4b80cea0d7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"classification\":\"$sClassification$\",\"paymentItemId\":\"$sBatchItemID$\",\"paymentItemType\":\"$sbatchItemTypeName$\", \"creditNoteId\":$sCreditNoteID$}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}}],"branches":[{"uid":"f14d1657-3ff4-4755-a094-e0f27879f851","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"6e23bfeb-bf3f-4859-8308-fc05e1298ac7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sPOST$,{\"classification\":\"$sClassification$\",\"paymentItemId\":\"$sBatchItemID$\",\"paymentItemType\":\"$sbatchItemTypeName$\", \"creditNoteId\":$sCreditNoteID$}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sCurrentpaymentBatchItem$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"0"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Build string for POST API"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"nCurrentpaymentBatchItem"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$sNumberOfBatchItems.String:toNumber$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]}],"branches":[{"uid":"b971bf13-6c0e-429f-91a3-2b9a2e5805e6","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"326796de-e032-466b-bc09-bc35eb35a476","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"cf9ded83-709d-4666-bf0f-1fb92a48f531","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dBatchResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sResponse"}},{"uid":"61d7419c-d548-4fd3-bacc-85375c66d71f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$, Response:  $sResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0c31b1d3-7956-4649-a3b2-5577d219ac78","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$.<br>\n<br>\n<strong>FAILED TO RETURN 'GET API' RESPONSE FOR BATCH ID: $sBatchID$</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$,  $sErrorMessage$<br>\n<br>\nRESPONSE: $sResponse$<br> \n<br>\nMake sure the bath ID is valid<br>\n<br>\n\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"ForeignLogin","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"40904e26-7769-4ed6-8d0e-8d0eb6942c75","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Find PM batch "}}]},{"uid":"8293b419-fff6-45dc-8bd7-7c40b3368b41","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"369dce23-0bbd-4984-a0c7-6410028f6307","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"68a984ab-6f5b-4014-82a1-941309e11ed8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"items\":[$sPOST$]}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}},{"uid":"461eb8a6-ffef-433d-aea7-9dc503bd235b","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIPosrtURL$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Accept"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$sPOST$"}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"dPOSTResponse"}},{"uid":"3fd6052a-9be6-46bc-88a3-9478cfff380e","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dPOSTResponse{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"message\":"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":",\"className\""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":false}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sResponse"}},{"uid":"afaea69f-a962-406d-9dd3-ea99f1a2410d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3bf26aed-112f-411f-a15a-8ff49b48200e","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Batch successfully calculated"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>COMPLETED SUCCESSFULLY</strong>.<br>\n<br>\n<strong>For BatchID: $sBatchID$, Branch: $sBranch$ <br>\n<br>\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]}],"branches":[{"uid":"dfdc6cac-12e8-4323-9027-086699675aad","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"826a6560-f565-445f-a3b7-e54a707d509e","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"14ee2034-2c10-4756-875e-e1744eab4ac9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e9b41c2f-d4dd-478e-8731-926cde0a83e0","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sResponse$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"invoice id: "}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"is being aggregated"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sInvoiceID"}},{"uid":"93644e1b-722c-4775-ac66-82093c05cca5","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"vt-prod-app-lst"}},{"name":"database","value":{"type":"STRING","string":"Dragon"}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"username"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Dragon DB Production","lockerName":"Dragon DB","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"38d4b185-4799-4704-8e52-f592ec1e6c5a","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"270e7c93-d34d-4062-998d-144eca64d299","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select ClaimSubmissionNumber from VT_ClaimSubmission where ClaimSubmissionID = (\tselect ClaimSubmissionID from vt_claimsubmission_invoice where InvoiceID = )$sInvoiceID$"}},{"name":"fetchSize","value":{"type":"NUMBER","number":"1"}},{"name":"timeOut","value":{"type":"NUMBER","number":"30"}}],"returnTo":{"type":"VARIABLE","variableName":"tClaimWithIssue"}},{"uid":"0dfce97c-6d92-45d7-b116-27c67a9e7997","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$tClaimWithIssue[0][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sClaimWithIssues"}},{"uid":"d44283ae-4d58-4fb6-844d-cd3273f272eb","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"e7c200b8-7902-4dba-859e-41ffd357c411","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sResponse$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Suboptimal invoice aggregation order"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Invoice error - get claim "}}]},{"uid":"f27d15b2-bf25-4740-b8cc-335ebc7875ce","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: 116, Error Message: $sResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"3ad7bf51-2863-4122-9304-e6cce9b185be","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$, Branch: $sBranch$<br>\n<br>\n<strong>FAILED TO CALL 'POST API' FOR BATCH ID: $sBatchID$</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nRESPONSE: $sResponse$<br>\n<br>\nClaim: $sClaimWithIssues$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"55bda1e7-a1f3-4482-8523-a285a76ce194","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sResponse$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"2b907ecb-ad57-4e0c-8fa9-ea6a2315f962","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"704670dc-ec9e-487b-836f-1c8b7c234221","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"93bc2459-e420-4b4f-a253-fb0e93a24dca","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$, Response: $sResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b4d54ae8-9ad7-4a63-8d4f-14a8e800ccef","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$, Branch: $sBranch$<br>\n<br>\n<strong>FAILED TO CALL 'POST API' FOR BATCH ID: $sBatchID$</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nRESPONSE: $sResponse$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"03ecce99-a16e-4470-8d2b-ff37edf776c7","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Call click API"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"CLICK BOT APIs"}}]},{"uid":"dec8ab0e-5746-4c2f-91c1-1f57f080e9aa","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}}],"branches":[{"uid":"0f4c892d-7511-4522-b890-e5fd1c34626e","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"cf031d89-bdf2-4040-8efd-b23f6610eb73","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"c0ee3d61-4570-49fc-a3c3-e99d213e9dec","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$, Response: Batch ID does not exists"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"fde56a68-981a-464a-b365-a2926a734d39","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Click bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nClick bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$<br>\n<br>\nIt looks like the batch ID does not exist. \n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"string":"Basic","type":"STRING"}}]},{"uid":"aad5824b-0449-4517-a467-53fe2ab2e919","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCurrentBatchDetails"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel_MS"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Run click bot functionality"}}]},{"uid":"13b36e06-d3cf-4d49-b5fe-328ded408354","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e7d212fc-d00c-43b2-9d54-5d2919e1653f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"435f9847-0f99-4268-b113-110297f82652","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c4b73cfc-c251-48a3-b80d-0dd6e1a54951","commandName":"DeleteCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"A2"}},{"name":"deleteOption","value":{"type":"STRING","string":"EntireRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCurrentBatchDetails"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel_MS"}}]},{"uid":"377f8704-5b4f-48a3-9968-c140587d2b45","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}],"branches":[{"uid":"09a4a01c-ffad-4ae6-97c3-b3a1853cfb44","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3389a441-f937-4978-bfca-743d6058f2e2","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"02cae352-478c-486c-aee0-a7cf7fed8633","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Click bot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"68ec53d7-c8d5-4a99-ba1b-29c48ad6bf4e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Clear Excel "}}]}],"variables":[{"name":"dLoginResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sCookie","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAPIURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sErrorLine","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dBatchResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sBatchResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sNumberOfBatchItems","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBatchItemID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sEmailRecipient","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"sErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nCurrentpaymentBatchItem","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sCurrentpaymentBatchItem","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sbatchItemTypeName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClassification","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sCreditNoteID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBatchID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sPOST","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sDefaultRecipient","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sSource","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"EasterEgg"}},{"name":"dEmailDetails","description":"","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sEmailMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"LBatchIDs","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"sCurrentBatchID","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"rCurrentBatchDetails","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sCounter","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sRowNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAPIPosrtURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dPOSTResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBranch","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sInvoiceID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"tClaimWithIssue","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"sClaimWithIssues","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":["326796de-e032-466b-bc09-bc35eb35a476","3389a441-f937-4978-bfca-743d6058f2e2","3ad7bf51-2863-4122-9304-e6cce9b185be","3bf26aed-112f-411f-a15a-8ff49b48200e","5421a712-379c-4d13-a893-a9fb52917021","704670dc-ec9e-487b-836f-1c8b7c234221","a9ce5aa4-2cd7-4b41-af6e-a2428dab548d","afaea69f-a962-406d-9dd3-ea99f1a2410d","f4d6ac94-eb80-405f-843b-9d94d23bf78c"],"packages":[{"name":"Database","version":"2.2.0-20201112-223343"},{"name":"Delay","version":"2.2.0-20201126-165137"},{"name":"Dictionary","version":"3.2.0-20201126-165138"},{"name":"Email","version":"3.2.0-20201120-062604"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"Excel_MS","version":"5.3.0-20201208-090251"},{"name":"Excel","version":"2.4.0-20201126-165604"},{"name":"File","version":"3.2.0-20201126-165151"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"JSONHandler","version":"1.2-20200521-104916"},{"name":"List","version":"2.2.0-20201126-165427"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"Loop","version":"2.1.0-20201126-165429"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"Rest","version":"3.2.0-20201112-224735"},{"name":"Step","version":"2.0.0-20201208-065513"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"TaskBot","version":"2.0.1-20201208-065519"}],"workItemTemplateName":null}