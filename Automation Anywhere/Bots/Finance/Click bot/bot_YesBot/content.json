{"triggers":[],"nodes":[{"uid":"683ee804-2026-470b-abc1-7e5bb6b52617","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"be196619-2815-414b-aa8a-d3b82f7fd08d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e791c2fc-df7e-49f6-be31-b0f327680284","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://blaze.vatit.com:1611"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIURL"}},{"uid":"66b4caef-2f61-4848-bffb-921a35a0c376","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://blaze.vatit.com:1611/dragon-api/payments/batches"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIPosrtURL"}},{"uid":"4aa2d4f1-59f5-4e69-a073-6e2523956268","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://blaze.vatit.com:1611/blaze-api/1.0/clients"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIGetURL"}},{"uid":"6532b079-66a9-484a-ba30-c63af4e0339b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"reconciled"}}],"returnTo":{"type":"VARIABLE","variableName":"sClassification"}},{"uid":"3ccfc250-2e56-4936-9e3c-eced06223c30","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"null"}}],"returnTo":{"type":"VARIABLE","variableName":"sCreditNoteID"}},{"uid":"5e53ce03-6978-4b4e-8eb7-f684bd50d2a9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\automation\\VATit Processing (Pty) Ltd\\VAT IT Automation - Bots Working Folders\\Finance\\ClickBot"}}],"returnTo":{"type":"VARIABLE","variableName":"sFilePath"}},{"uid":"07faa5aa-9013-4921-8a79-a1f43df98bdc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"natasjavh@vatit.com"}}],"returnTo":{"type":"VARIABLE","variableName":"sDefaultRecipient"}},{"uid":"2128c995-5a5b-43cd-9e9b-63bfaf6b47e7","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"4d53f415-25f1-4842-98ad-6542f0772ebb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\elzetteb\\Downloads"}}],"returnTo":{"type":"VARIABLE","variableName":"sFilePath"}},{"uid":"8053deda-af2c-4ba6-9014-2f1fa1bb45bb","commandName":"assign","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceDictionary","value":{"type":"DICTIONARY","dictionary":[{"key":"emailMessage","value":{"type":"STRING","string":"954F72\"><div class=\"WordSection1\"><p class=\"MsoNormal\">6588<o:p></o:p></p><p class=\"MsoNormal\"><o:"}},{"key":"emailFrom","value":{"type":"STRING","string":"elzetteb@vatit.com"}}]}}],"returnTo":{"type":"VARIABLE","variableName":"dEmailDetails"}},{"uid":"e8c70ace-4f9e-40cf-8ece-271fcc97d7d8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://dragon-uat.vatit.com:1611"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIURL"}},{"uid":"315735a5-e9b2-410c-b159-b731ed1a45a0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://dragon-uat.vatit.com:1611/dragon-api/payments/batches"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIPosrtURL"}},{"uid":"49ba3ac7-b1f0-4164-86eb-cb5eddc5e63a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://dragon-uat.vatit.com:1611/blaze-api/1.0/clients"}}],"returnTo":{"type":"VARIABLE","variableName":"sAPIGetURL"}},{"uid":"64df92b7-bb1f-4fe4-ab3d-a7ec5841ccb7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"elzetteb@vatit.com"}}],"returnTo":{"type":"VARIABLE","variableName":"sDefaultRecipient"}},{"uid":"4265882d-d6c3-4a9c-abfa-aa550ac6811b","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"6353"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchID"}},{"uid":"3eeb5bb8-e3bd-4378-a546-0f8b66bd0952","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"File"}}],"returnTo":{"type":"VARIABLE","variableName":"sSource"}},{"uid":"51bdca00-15e4-47a9-a1f9-804d2f3ff587","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Email"}}],"returnTo":{"type":"VARIABLE","variableName":"sSource"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"INPUT VALUES FOR TESTING"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Variable declaration "}}]},{"uid":"67ce2311-5ae2-4aab-a61a-6b43ee522a3c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e65b5d4f-f9af-4317-9180-4059db2b3008","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cbd5fe84-92ea-4030-b72e-20b3119d0db1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dEmailDetails{emailMessage}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailMessage"}},{"uid":"7e7c8ab7-7233-4ccd-9145-25e249c051a7","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sEmailMessage$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"<div class=\"WordSection1\"><p class=\"MsoNormal\">"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"<o:p></o:p></p><p class=\"MsoNormal\">"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailMessage"}},{"uid":"8a941b95-c6d8-418b-87bb-e4649e0e00ff","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dEmailDetails{emailFrom}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}},{"uid":"f965fdd9-3232-426e-833c-22a2612e4f75","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"EXTRACTED MESSAGE\n\nEmail Recipient $sEmailRecipient$\nEmail Message: $sEmailMessage$\n\n"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b3fc7742-ba08-42db-bcef-3833bacff586","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sEmailMessage$"}},{"name":"delimiter","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"LBatchIDs"}},{"uid":"c0298aed-32b5-4075-9b03-ad38952df2b5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e1c06b28-2fb1-41b1-a24a-66f62667f4e9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"996e42e9-c85e-44a2-b70d-c200bdec6314","commandName":"CreateSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/YesBot-Urgent.xlsx"}},{"name":"sheetName","value":{"type":"STRING","string":""}},{"name":"passwordToOpen","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"passwordToEdit","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"b78ccb26-8182-4a64-9b3b-03f106ee55bb","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"BatchID"}}]},{"uid":"72bb73fb-f51e-4f06-9f2b-9391aaacfb18","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"EmailAddress"}}]}],"branches":[{"uid":"88149d5b-7a72-450d-94f1-e8955e753619","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"3dc08685-7cbd-4b04-a909-36ffff3f2847","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/YesBot-Urgent.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"810fb46c-d629-4d9c-a464-ceabae034696","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"value","value":{"type":"STRING","string":"BatchID"}}]},{"uid":"835854ea-76e4-4e7d-ba36-60f75e66f768","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","string":"EmailAddress"}}]},{"uid":"b9760528-410b-4021-bd9e-479641363855","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sFilePath$/YesBot-Urgent.xlsx"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"f9c37f07-27a1-4fdb-a8a4-0df610b0a123","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/YesBot-Urgent.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"56dd4bbc-8879-4c79-97db-e44ffba7ed5a","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A2"}}]}],"branches":[{"uid":"6c333e6f-840d-4405-bfa5-e15b7eb59333","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5818395c-b8cf-4c2d-8335-4f47d9663969","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"File path do not exists"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a9ce5aa4-2cd7-4b41-af6e-a2428dab548d","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"10582570-42e5-4d2f-84b6-91f9624c5f89","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Error line: $sErrorLine$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"47329acb-60bd-45a8-8d66-4f5139c6aa86","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe Yes bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO FIND FILE PATH</strong><br>\n<br>\nThis is the current file path: $sFilePath$<br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease make sure that the file path exists and then try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"f2384016-df4f-443b-b1ee-dcccd251c96f","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]},{"uid":"a762e631-c9c3-48d8-9555-23b17be514e7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5c85f04d-5630-46e0-9980-69a9a862aead","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$sCurrentBatchID$"}}]},{"uid":"c9c93e4f-6d7e-4663-9dc2-b2eae3bba011","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"68c0ecad-9dd0-4b05-9182-a0c22fee9f63","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}},{"name":"value","value":{"type":"STRING","expression":"$sEmailRecipient$"}}]},{"uid":"7f115124-f870-43d1-a111-b3a18d83aaea","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellDown"}}]},{"uid":"5ac2db38-67f4-4d19-aac9-423114f95f5a","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellLeft"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"sCurrentBatchID"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"LBatchIDs"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"branches":[{"uid":"21c9caf9-ffd1-4784-ad9e-22ce3bd25796","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"36b2459e-f18c-48ee-851b-0181a05f87bd","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"bdfb7355-18c6-4acf-9351-0377c6e53a45","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/YesBot.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"28059a80-b511-466c-9782-4986647c983a","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"3"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]}],"branches":[{"uid":"c6853d8e-275e-4846-a442-8050549a68be","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"74040a8d-7a74-4b98-a111-e4d4b577d66e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"FILE NOT FOUND - please replace the file with the \nTitle: YesBot\nHeading 1: BatchID\nHeading 2: EmailAddress"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f4d6ac94-eb80-405f-843b-9d94d23bf78c","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"ebc4e737-54e3-4fab-a4ac-5bf3242b4f06","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b22cf8c0-7852-4389-9346-5adcba0d8c12","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe Yes bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO FIND THE FILE</strong><br>\n<br>\nThis is the current file path of the file: $sFilePath$<br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease make sure that FILE NOT FOUND - please replace the file with: <br>\n<br> \nTitle: Yes Bot<br>\n<br>\nHeading 1: BatchID<br>\n<br>\nHeading 2: EmailAddress<br>\n<br>\nThis bot will run again in 24 hours. \n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"7ac19b0b-5d62-4407-adf5-67358ee90686","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSource$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"File"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"a3cb0adc-2f64-467d-957b-5ae75ec1bde4","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"bae4f323-47a0-4f42-b0fb-f9eac43ff6e1","commandName":"stopTask","packageName":"TaskBot","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSource$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Email"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Find source of data"}}]},{"uid":"a94f745a-948b-4121-8b7a-f80d8cd4e530","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"80504040-5e76-4a2a-a036-a971c54fc64f","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}},{"uid":"3284740c-7319-45e4-af59-0fd0ca391646","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"590750c8-532e-42cf-a8f9-2ff965f87c9e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sCounter"}},{"uid":"8ce427db-b3a6-440b-b2d6-a2924c0d9000","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCurrentBatchDetails[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchID"}},{"uid":"2ce1e134-0007-4596-a36e-c9346c98586e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCurrentBatchDetails[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}},{"uid":"c81e1e3d-fecc-40ee-bc5f-eb6f5de044bb","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c713311b-3169-4918-8af3-f19402933563","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sDefaultRecipient$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":" "}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"2d075f67-3864-4903-901d-7cf57c3c0c76","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e9ba11c0-e03e-40d5-b1d2-d694037c9a81","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sDefaultRecipient$"}}],"returnTo":{"type":"VARIABLE","variableName":"sEmailRecipient"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"@"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"."}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"1e4c90e1-e238-40db-8262-0855aef60ee9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"22387b7a-8863-4b5c-84b9-86dea47c9188","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"358e7ebb-373a-4972-9f3a-bcc5fa836d63","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIURL$/login"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"headerContentType","value":{"type":"STRING","string":"application/x-www-form-urlencoded"}},{"name":"urlEncodedPostParameters","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"user"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Dragon Credentials","lockerName":"Automation Credentials","attributeName":"UserName"}}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"pass"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Dragon Credentials","lockerName":"Automation Credentials","attributeName":"Password"}}}]}]}}],"returnTo":{"type":"VARIABLE","variableName":"dLoginResponse"}},{"uid":"b5148d3a-1f38-4718-9844-e871b49212ae","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dLoginResponse{\"Set-Cookie\"}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":";"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sCookie"}},{"uid":"f7e97a57-8068-40d2-8bb8-7df89f2dd177","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"DragonUser=\"Elzette Buys\";$sCookie$"}}],"returnTo":{"type":"VARIABLE","variableName":"sCookie"}},{"uid":"39c7ce61-0379-4b82-b4f5-eafa15b6e5a0","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"LOGIN WAS SUCCESFUL\n\nCookie: $sCookie$\nLoginResponse: $dLoginResponse{\"Body\"}$\nLoginResponse Set-cookie: $dLoginResponse{\"Set-Cookie\"}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"8de750b9-0253-4ac8-8da5-0548ffc373ae","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a7b671ee-d9de-43b9-acec-720490fcbd30","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"FAILED TO CONNECT TO DRAGON"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"5421a712-379c-4d13-a893-a9fb52917021","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"9c0779ec-9923-40c5-ad90-e94a4dade662","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"YesBot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"79fadb24-8ad0-4c94-9f1b-a4281f5aef71","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nYes bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO CONNECT TO DRAGON</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong> or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"f45b0c01-e3fa-4298-95c4-5f325774d59a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Dragon authentication "}}]},{"uid":"868a69fa-4e10-440a-9783-d0abc7bb41ca","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b6789ff5-07e5-4e1b-b28f-b38ecbc2bdc5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"064ee2b3-0c33-4ad8-820f-8c6d1bdd9b9e","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIURL$/blaze-api/1.0/payments/batches/items/grid-view?batchIds=$sBatchID$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}}],"returnTo":{"type":"VARIABLE","variableName":"dBatchResponse"}},{"uid":"792a4434-d11a-40cf-a787-5e6308355876","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonString","value":{"type":"STRING","expression":"$dBatchResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchResponse"}},{"uid":"bb40acda-1053-4009-aab5-c055005571af","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","string":"paymentBatchItems.length() "}}],"returnTo":{"type":"VARIABLE","variableName":"sNumberOfBatchItems"}},{"uid":"40e584ec-47d9-41ce-b21d-a1d7a870ca21","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"PM BATCH FOUND"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"b971bf13-6c0e-429f-91a3-2b9a2e5805e6","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4bd7e888-56a6-45b9-a29d-b197cb56564d","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"FAILED TO FIND PM BATCH DETAILS"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"61d7419c-d548-4fd3-bacc-85375c66d71f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"YesBot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0c31b1d3-7956-4649-a3b2-5577d219ac78","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nYes bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$.<br>\n<br>\n<strong>FAILED TO RETURN 'GET API' RESPONSE FOR BATCH ID: $sBatchID$</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"ForeignLogin","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"40904e26-7769-4ed6-8d0e-8d0eb6942c75","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]},{"uid":"f2a73f68-3c42-4cca-a8a6-6ff36d60a16d","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"58394935-b8fc-4c40-8dc4-36e294e5684f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"53b6902b-b81b-416d-a1c9-85c3a38d4d6a","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nCurrentpaymentBatchItem$-1"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentpaymentBatchItem"}},{"uid":"54a89001-6af2-4030-b031-5a45f843fa81","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].batchItemId"}}],"returnTo":{"type":"VARIABLE","variableName":"sBatchItemID"}},{"uid":"3ec16aa7-657d-4c7a-96e9-699f1708d543","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].batchItemTypeName"}}],"returnTo":{"type":"VARIABLE","variableName":"sbatchItemTypeName"}},{"uid":"345ad2ca-9784-4b2a-a673-3a230377b3e6","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].clientId"}}],"returnTo":{"type":"VARIABLE","variableName":"sClientID"}},{"uid":"9abccf9b-0fb3-4c18-9203-85f9fc501f44","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].clientName"}}],"returnTo":{"type":"VARIABLE","variableName":"sClientName"}},{"uid":"33d2e239-5492-456c-a8ac-c79a866f06a7","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].sourceId"}}],"returnTo":{"type":"VARIABLE","variableName":"sSourceID"}},{"uid":"d5982b64-2b44-4042-9552-b8e9b06b9a8d","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].itemNumber"}}],"returnTo":{"type":"VARIABLE","variableName":"sClaimNumber"}},{"uid":"5d313478-9bb2-44f2-84f9-f52c34e3e40a","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"ClaimDetail"}},{"name":"jsonQuery","value":{"type":"STRING","expression":"paymentBatchItems[$sCurrentpaymentBatchItem$].BranchID"}}],"returnTo":{"type":"VARIABLE","variableName":"sBranch"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Find PM batch details"}}]},{"uid":"9a6e6934-b686-4c28-881a-0138ad956b77","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3692f94f-09ff-4fb2-9c21-91fe51f09eb7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"782619d8-1c33-401b-8bb2-8fcf3f856f36","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"clientId\":\"$sClientID$\",\"type\":\"Contact\",\"verified\":true}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}},{"uid":"babf0f8e-6860-4713-8dda-968ee567d350","commandName":"restPut","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIPosrtURL$/$sBatchID$/item/$sSourceID$/clientdetails"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Accept"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Cookie"}},{"key":"value","value":{"type":"STRING","expression":"$sCookie$"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$sPOST$"}}],"returnTo":{"type":"VARIABLE","variableName":"dPOSTResponse"}},{"uid":"aa7ff8be-3408-4684-8acf-a0a45e8d9b2e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"clientId\":\"$sClientID$\",\"type\":\"Address\",\"verified\":true}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}},{"uid":"eed7b31e-d826-489f-a500-042e8d0b1a9c","commandName":"restPut","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIPosrtURL$/$sBatchID$/item/$sSourceID$/clientdetails"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Accept"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Cookie"}},{"key":"value","value":{"type":"STRING","expression":"$sCookie$"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$sPOST$"}}],"returnTo":{"type":"VARIABLE","variableName":"dPOSTResponse"}},{"uid":"de4c792e-8e60-4cc6-88ab-7f742bc19c9d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"clientId\":\"$sClientID$\",\"type\":\"Account\",\"verified\":true}"}}],"returnTo":{"type":"VARIABLE","variableName":"sPOST"}},{"uid":"b4b6d7c0-e540-42bb-96df-b82055045b58","commandName":"restPut","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIPosrtURL$/$sBatchID$/item/$sSourceID$/clientdetails"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Accept"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Cookie"}},{"key":"value","value":{"type":"STRING","expression":"$sCookie$"}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"$sPOST$"}}],"returnTo":{"type":"VARIABLE","variableName":"dPOSTResponse"}},{"uid":"8555f2c6-f64f-4dc0-903c-795643082dd8","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"POST WAS SUCCESSFUL"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"92f4b403-e305-4f32-8a82-4b01653574f8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6a624751-846b-4637-9a24-4ab51a036351","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$sAPIGetURL$/$sClientID$/details?sourceId=$sSourceID$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}}],"returnTo":{"type":"VARIABLE","variableName":"dClientDetailResponse"}},{"uid":"9d8e2c50-f088-491d-a487-0a8b569f80b9","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"GetAddress"}},{"name":"jsonString","value":{"type":"STRING","expression":"$dClientDetailResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sClientDetailResponse"}},{"uid":"367e2b3d-d3fe-40b7-96c5-aefa0e70190b","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"GetAddress"}},{"name":"jsonQuery","value":{"type":"STRING","string":"clientAddressInformation.addresses"}}],"returnTo":{"type":"VARIABLE","variableName":"sAddressInfo"}},{"uid":"14ba16bd-cb10-48a0-934b-10698e07fa77","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sAddressInfo$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"addressLine1\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\",\"city\":"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sAddressLine1"}},{"uid":"243b9743-745b-4568-bb0c-7d5fb3570732","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sAddressInfo$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":",\"type\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\"}],\""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"sAddressType"}},{"uid":"a0c037ce-f458-4d94-aa40-ec530c994d4e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$sAddressInfo$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a5f73b0f-e63b-467e-8a8d-5c4d32625049","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3e3deffd-c7a9-45fa-9184-8f85045d6025","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sClientIssues$; $sClientName$, $sClaimNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"sClientIssues"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressLine1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressLine1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":" "}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Return client issues"}}]}],"branches":[{"uid":"374cbe6a-e3e0-42d0-beca-086982ea1034","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7684e3c7-db8a-4191-ba31-17fe0334d1c4","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"FAILED POST API"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b28062c9-e798-44d0-9fd4-46274e1e22af","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"YesBot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"cd4acad2-05b1-4497-bb37-e274a08b819d","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"cc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nYes bot has <strong>FAILED</strong> on this Bacth ID: $sBatchID$, Branch: $sBranch$,  Claim Number: $sClaimNumber$<br>\n<br>\n<strong>FAILED TO CALL 'POST API'  </strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong>  or wait for the bot to run again in 24 hours.\n\n\n\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"6321ea4a-e300-40f1-ab35-f3adfabad34b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sFailedClaims$, $sClaimNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"sFailedClaims"}},{"uid":"7a7069eb-00f7-48e9-b4b9-42ee1c60d614","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"POST API"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"nCurrentpaymentBatchItem"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$sNumberOfBatchItems.String:toNumber$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Find PM batch details, POST API and return client issues"}}]},{"uid":"6089a558-39cf-4168-8042-89a39a5105d4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"bbe22b75-1f4c-4544-9b35-4d73541b9c61","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1a7264ae-598b-44b6-b2de-7f8ce668a0a7","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Some clients may have missing information "}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good day, <br> \n<br> \nFor Batch ID $sBatchID$, the following clients had issues with their address, banking details and/or contact details:<br>\n<br> \n$sClientIssues$ <br>\n<Bbr>\nPlease look into this before proceeding with the payment batch. \n<br>"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"10c21222-2817-4479-9af8-5f8262b28cf8","commandName":"step","packageName":"Step","disabled":false,"children":[],"attributes":[{"name":"title","value":{"type":"STRING","string":"Clear failed list"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressLine1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressLine1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":" "}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Send client issues to batch ID email address"}}]},{"uid":"35b3f633-668d-467e-9a2a-1a23d7e3dccf","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot completed successfully"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe Yes bot has <strong>completed successfully</strong>.<br>\n<br>\nFor Batch ID: $sBatchID$<br>\n<br> \n\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"dec8ab0e-5746-4c2f-91c1-1f57f080e9aa","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$nCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"nCounter"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCurrentBatchDetails"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel_MS"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"For each Batch ID in list"}}]},{"uid":"f6924739-387f-4846-9539-fbdfc448b209","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e7d212fc-d00c-43b2-9d54-5d2919e1653f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"435f9847-0f99-4268-b113-110297f82652","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c4b73cfc-c251-48a3-b80d-0dd6e1a54951","commandName":"DeleteCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"A2"}},{"name":"deleteOption","value":{"type":"STRING","string":"EntireRow"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCurrentBatchDetails"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel_MS"}}]},{"uid":"377f8704-5b4f-48a3-9968-c140587d2b45","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}],"branches":[{"uid":"09a4a01c-ffad-4ae6-97c3-b3a1853cfb44","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"02cae352-478c-486c-aee0-a7cf7fed8633","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"68ec53d7-c8d5-4a99-ba1b-29c48ad6bf4e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Clean up data"}}]}],"branches":[{"uid":"65918f81-696f-4893-b017-70f0cc105596","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a34dfe7b-47a3-4c9f-ae7e-075f263c2430","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"FAILED TO CONNECT TO DRAGON"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"879ae13d-c43d-4100-821c-2316bed40f46","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLine"}},{"uid":"6f80b444-1f2f-4b45-8d38-61bf2533b615","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sFilePath$/logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"YesBot - Error line: $nErrorLine.Number:toString$, Error Message: $sErrorMessage$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"29d1a4af-6ca2-405a-85b9-c85dcb282e55","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sEmailRecipient$"}},{"name":"cc","value":{"type":"STRING","expression":"$sDefaultRecipient$"}},{"name":"bcc","value":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"subject","value":{"type":"STRING","string":"Yes bot error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nYes bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>ERROR LINE:</STRONG> $sErrorLine$, $sErrorMessage$<br>\n<br>\nPlease try again later by submitting a <strong>NEW EMAIL (Do not forward the previous email that was sent)</strong> or wait for the bot to run again in 24 hours.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"e0d48797-b2e4-41fe-b1ff-46ba5c577ca4","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLine"}}}]}],"variables":[{"name":"dLoginResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sCookie","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAPIURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sErrorLine","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dBatchResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sBatchResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sNumberOfBatchItems","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBatchItemID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sEmailRecipient","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"elzetteb@vatit.com"}},{"name":"sErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nCurrentpaymentBatchItem","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sCurrentpaymentBatchItem","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sbatchItemTypeName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClassification","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sCreditNoteID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBatchID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sPOST","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dPOSTResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sDefaultRecipient","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sSource","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"EasterEgg"}},{"name":"dEmailDetails","description":"","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sEmailMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"LBatchIDs","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"sCurrentBatchID","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"rCurrentBatchDetails","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sCounter","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sRowNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAPIPosrtURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClientID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClientName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sSourceID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClaimNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sFailedClaims","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dClientInfo","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sClientDetailResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClientAddress","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dClientDetailResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sNumberOfClaims","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nCounterClaim","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sBranch","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAPIGetURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"saddressId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAddressLine1","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAddressType","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sNumberOfClientDetails","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nCurrentClientDetails","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sCurrentClientDetails","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAddressInfo","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sClientIssues","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Client Name, Claim Number"}}],"breakpoints":["02cae352-478c-486c-aee0-a7cf7fed8633","064ee2b3-0c33-4ad8-820f-8c6d1bdd9b9e","3284740c-7319-45e4-af59-0fd0ca391646","358e7ebb-373a-4972-9f3a-bcc5fa836d63","36b2459e-f18c-48ee-851b-0181a05f87bd","377f8704-5b4f-48a3-9968-c140587d2b45","39c7ce61-0379-4b82-b4f5-eafa15b6e5a0","435f9847-0f99-4268-b113-110297f82652","47329acb-60bd-45a8-8d66-4f5139c6aa86","4bd7e888-56a6-45b9-a29d-b197cb56564d","5818395c-b8cf-4c2d-8335-4f47d9663969","74040a8d-7a74-4b98-a111-e4d4b577d66e","782619d8-1c33-401b-8bb2-8fcf3f856f36","a7b671ee-d9de-43b9-acec-720490fcbd30","a9ce5aa4-2cd7-4b41-af6e-a2428dab548d","b28062c9-e798-44d0-9fd4-46274e1e22af","e65b5d4f-f9af-4317-9180-4059db2b3008","f2a73f68-3c42-4cca-a8a6-6ff36d60a16d","f965fdd9-3232-426e-833c-22a2612e4f75"],"packages":[{"name":"Delay","version":"2.2.0-20201014-042532"},{"name":"Dictionary","version":"3.2.0-20201014-042532"},{"name":"Email","version":"3.0.0-20200901-105426"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"Excel","version":"2.3.0-20201027-160012"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"If","version":"2.1.0-20200825-071156"},{"name":"JSONHandler","version":"1.2-20200521-104916"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20200831-031540"},{"name":"MessageBox","version":"2.1.0-20200831-031541"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Rest","version":"3.1.0-20200824-092129"},{"name":"Step","version":"2.0.0-20200907-072944"},{"name":"String","version":"3.1.0-20200831-031943"},{"name":"TaskBot","version":"2.0.1-20200907-072949"}],"workItemTemplateName":null}