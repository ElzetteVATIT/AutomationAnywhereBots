{"triggers":[],"nodes":[{"uid":"376b3a2a-6956-4b13-8bf8-a8deefcb9a9c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"567e362c-7dd8-4f92-893b-a3c5e8903b11","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\AA\\Finance\\Forex Bot"}}],"returnTo":{"type":"VARIABLE","variableName":"WorkingFolder"}},{"uid":"eaaec1a1-eb4d-44b6-97f3-07ff3e598966","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$WorkingFolder$\\Rates File.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"SourceFileFullPath"}},{"uid":"5f511795-fac7-4833-a11f-1b6c9bc871f5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"https://forex-api.vatit.com"}}],"returnTo":{"type":"VARIABLE","variableName":"baseURL"}},{"uid":"6d495981-8356-4fc5-8329-e174b76f2737","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"EmailAddresses"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Initialization"}}]},{"uid":"a3fd5a5b-5059-4bc0-8a45-681acaaa854f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3d58b1d3-a8c9-4a37-ad9b-5232dd9518a1","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"46af0870-5de7-4f06-b17c-2edff24e60b6","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://login.microsoftonline.com/4167dd15-4d14-4264-85e4-e113f2f76e9f/oauth2/v2.0/token"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"headerContentType","value":{"type":"STRING","string":"application/x-www-form-urlencoded"}},{"name":"urlEncodedPostParameters","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"client_id"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Forex API Service","lockerName":"VAT IT API Services","attributeName":"client_id"}}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"client_secret"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"Forex API Service","lockerName":"VAT IT API Services","attributeName":"client_secret"}}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"grant_type"}},{"key":"value","value":{"type":"STRING","string":"client_credentials"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"scope"}},{"key":"value","value":{"type":"STRING","string":"https://api.vatit.com/.default"}}]}]}}],"returnTo":{"type":"VARIABLE","variableName":"AuthResponse"}}],"branches":[{"uid":"8f74e540-863e-45a6-b896-740a020eded4","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"502c9bc9-03f8-4efb-8a16-a10949195801","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$ErrorLineNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"ErrorLineNum_String"}},{"uid":"3839d193-74b6-418c-b696-4876bf7bdf74","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$EmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":"darrenc@vatit.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Forex Bot | Failed to Authenticate"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Good Day,<br>\n<br>\nThe Forex Rates bot has <strong>FAILED</strong>.<br>\n<br>\n<strong>FAILED TO AUTHENTICATE TO THE FOREX API</strong><br>\n<br>\n<strong>ERROR LINE:</STRONG> $ErrorLineNum_String$<br>\n<strong>ERROR MESSAGE:</strong> $ErrorMessage$<br>\n<br>\nPlease try again later.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]},{"uid":"d385ee86-de31-4996-ba1b-3da83d9e2df1","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNum"}}}]},{"uid":"07504e3d-1e7d-403f-97a4-e9a550998a0f","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$AuthResponse{Body}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"\"access_token\":\""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"\""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"AccessToken"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Authentication"}}]},{"uid":"51399f66-c9fb-4c04-bb7b-c168e33e3d59","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0d29a1ac-0f7e-4d40-8e4b-40c4d1d09638","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$SourceFileFullPath$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"37a8f383-47b6-4a97-a839-283b9a3e81bd","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"RowNumber"}},{"uid":"991115aa-cee5-4ed6-98c4-a26aae105b78","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"dccde4c3-49db-4597-b37b-87d8f2c787bd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$CurrentForexPair[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"FromCurr"}},{"uid":"f0c7108c-1e9b-4ce5-89d7-c417b5445b11","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$CurrentForexPair[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"ToCurr"}},{"uid":"5e6bf515-f856-437b-8da3-ab122f6287e9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$CurrentForexPair[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"REquestedDate_String"}},{"uid":"d8252b76-fc4e-4ae6-a372-6812a2068d3a","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6793be5a-acac-457d-9c5a-bb98766e0d67","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"$baseURL$/api/exchange-rate?date=$REquestedDate_String$&from=$FromCurr$&to=$ToCurr$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Authorization"}},{"key":"value","value":{"type":"STRING","expression":"Bearer $AccessToken$"}}]}]}}],"returnTo":{"type":"VARIABLE","variableName":"ForexResponse"}},{"uid":"3902c7d1-4f27-479e-a672-7b9506be3833","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonString","value":{"type":"STRING","expression":"$ForexResponse{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"ForexJSONResponse_String"}},{"uid":"c4591255-6a72-4232-bcd6-b7e866871143","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"rate"}}],"returnTo":{"type":"VARIABLE","variableName":"ForexValue"}},{"uid":"eceb57da-d2f0-47fd-b193-69eacb41c302","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$RowNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"RowNum_String"}},{"uid":"f6273e2f-6ca3-4efd-874c-d7beacb3872f","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"D$RowNum_String$"}},{"name":"value","value":{"type":"STRING","expression":"$ForexValue$"}}]},{"uid":"f9d2e2b6-1772-40d1-b005-653a9da2ed55","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$RowNumber$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"RowNumber"}}],"branches":[{"uid":"6d82e5df-b42d-4c8a-9716-cc3504e83d74","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ce9559ff-9e45-4b79-b6d0-69df3524807b","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$RowNumber$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"RowNumber"}},{"uid":"4d0c4c87-9178-4119-a038-7945e4a7c34a","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$ErrorMessage$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"2"}}]},{"uid":"35ad84d5-1994-4641-91a3-7a54a23f735f","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNum"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"CurrentForexPair"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel"}}]},{"uid":"c4dbdf99-9032-4284-85e4-9d46f826d717","commandName":"SaveSpreadSheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"a01ac64c-0285-4ee4-b244-52afc8d927eb","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}},{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get Rates"}}]},{"uid":"c2261261-35b7-48f1-a8bb-0bda54c36cdf","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b8a71d61-572e-497a-8a3f-bdaf0864fa1d","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$EmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Forex Bot | Complete"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$WorkingFolder$/$SourceFile$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","string":"Good Day,<br>\n<br>\nThe Forex Rates bot has <strong>COMPLETED</strong>.<br>\n<br>\n<strong>Please see attached results</strong><br>\n<br>\n\nThank you!\n\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"UserName"}}},{"name":"ewsSecuredPassword","value":{"type":"CREDENTIAL","credential":{"name":"Automation User O365","lockerName":"Automation Credentials","attributeName":"Password"}}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Send Back Results"}}]},{"uid":"fc1c4b63-fcdd-4aa5-912e-3011c9fe708d","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"a8205038-53be-4bd4-9c97-790a54cc14f8","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$WorkingFolder$/$SourceFile$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Clean Up"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"CurrentForexPair","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"WorkingFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"SourceFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"FromCurr","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ToCurr","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"RequestedDate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"REquestedDate_String","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ForexResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"ForexJSONResponse_String","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ForexValue","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"RowNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"RowNum_String","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"AuthResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"AccessToken","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"baseURL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ErrorLineNum_String","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"EmailAddresses","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"CurrentTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"SourceFileFullPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":["0d29a1ac-0f7e-4d40-8e4b-40c4d1d09638","a3fd5a5b-5059-4bc0-8a45-681acaaa854f"],"packages":[{"name":"Email","version":"3.0.0-20200901-105426"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"Excel","version":"2.1.0-20200831-031843"},{"name":"File","version":"2.2.0-20200831-031057"},{"name":"JSONHandler","version":"1.2-20200521-104916"},{"name":"Loop","version":"2.1.0-20200831-031540"},{"name":"MessageBox","version":"2.1.0-20200831-031541"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Rest","version":"3.1.0-20200824-092129"},{"name":"Step","version":"2.0.0-20200907-072944"},{"name":"String","version":"3.1.0-20200831-031943"},{"name":"TaskBot","version":"2.0.1-20200907-072949"}],"workItemTemplateName":null}